<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">Reportes</h1>
    </div>
</div>
<div ng-controller="UserController as user_conreoller">
    <div ng-controller="LogController as log_controller" ng-init="log_controller.showData()">
        <div style="display: none;" class="modal fade" id="logsView" tabindex="-1" role="dialog"
             aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog" style="width: 800px">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button"
                                class="close" data-dismiss="modal"
                                aria-hidden="true">x
                        </button>
                        <span class="widget-icon"> <i class="fa fa-file-o"></i></span>
                        Detalles
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group col-sm-12">
                                    <label>Descripci&oacute;n</label>
                                <textarea class="form-control" rows="8" placeholder="Descripci&oacute;n"
                                          ng-model="log_controller.descripcionObjetoAux" disabled></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading" style="height: 45px">
                <div class="pull-right">
                    <select class="form-control input-sm" ng-model="log_controller.entries"
                            ng-change="log_controller.showData()">
                        <option value="{{log_controller.entries}}" selected>{{log_controller.entries}}
                        </option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                    </select>
                </div>
                <div class="pull-right">
                    <form>
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-addon input-sm"><i class="fa fa-search"></i></div>
                                <input type="text" class="form-control input-sm" placeholder="Busqueda"
                                       ng-model="searchLog">
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <div class="panel-body">
                <div class="dataTable_wrapper">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                        <tr class="panel-default">
                            <th>
                                <a href=""
                                   ng-click="sortType = 'idUser'; sortReverse = !sortReverse">
                                    Usuario
                                    <span ng-show="sortType == 'idUser' && !sortReverse"
                                          class="fa fa-caret-down"></span>
                                    <span ng-show="sortType == 'idUser' && sortReverse"
                                          class="fa fa-caret-up"></span>
                                </a>
                            </th>
                            <th>
                                <a href=""
                                   ng-click="sortType = 'lastDate'; sortReverse = !sortReverse">
                                    Fecha
                                    <span ng-show="sortType == 'lastDate' && !sortReverse"
                                          class="fa fa-caret-down"></span>
                                    <span ng-show="sortType == 'lastDate' && sortReverse"
                                          class="fa fa-caret-up"></span>
                                </a>
                            </th>
                            <th>
                                <a href=""
                                   ng-click="sortType = 'accion'; sortReverse = !sortReverse">
                                    Accion realizada
                                    <span ng-show="sortType == 'accion' && !sortReverse"
                                          class="fa fa-caret-down"></span>
                                    <span ng-show="sortType == 'accion' && sortReverse"
                                          class="fa fa-caret-up"></span>
                                </a>
                            </th>
                            <th>
                                <a href=""
                                   ng-click="sortType = 'tableName'; sortReverse = !sortReverse">
                                    db_table
                                    <span ng-show="sortType == 'tableName' && !sortReverse"
                                          class="fa fa-caret-down"></span>
                                    <span ng-show="sortType == 'tableName' && sortReverse"
                                          class="fa fa-caret-up"></span>
                                </a>
                            </th>
                            <!--<th>Accion</th>-->
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="log in log_controller.logs.logs| orderBy:sortType:sortReverse | filter:searchLog | pagination: log_controller.curPage * log_controller.pageSize | limitTo: log_controller.pageSize">
                            <td width="30%">
                                <p class="input-group">

                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default input-sm">
                                            <i ng-class="{'fa fa-male':user_controller.userSex[log.idUser]=='M', 'fa fa-female':user_controller.userSex[log.idUser]=='F'}"></i>
                                        </button>
									</span>
                                    <input type="text" ng-model="user_controller.userNames[log.idUser]"
                                           class="form-control input-sm">
                                </p>
                                <!--<span ng-bind="user_controller.userNames[log.idUser]"></span>-->
                            </td>
                            <td width="30%">
                                <p class="input-group">
                                    <input type="text" ng-model="log.lastDate"
                                           class="form-control input-sm">
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default input-sm">
                                            <i class="glyphicon glyphicon-calendar"></i>
                                        </button>
									</span>
                                </p>
                            </td>
                            <td align="center" width="20%"><span
                                    ng-class="{'label label-danger':log.accion == 'delete' , 'label label-success':log.accion == 'update' , 'label label-primary':log.accion == 'insert'}"
                            >{{log.accion +'d elemento con id: '+log.idRegistro+''}}
                            </span></td>
                            <td><span ng-bind="log.tableName"></span></td>
                            <td>
                                <a class="btn btn-primary btn-sm"
                                   data-target="#logsView"
                                   data-toggle="modal"
                                   ng-click="log_controller.fetchDescriptionObject(log.idLog);"><span
                                        class="widget-icon"><i class="fa fa-eye"></i></span> Ver</a>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                </div>

            </div>
            <div class="panel-footer">
                <p>Mostrando <span class="badge bg-default">{{log_controller.cantCurrentPage()}}</span> logs
                    de
                    <span class="badge bg-default">{{log_controller.logs.logs.length}}</span> entrada(s).
                </p>
                <ul style="" ng-show="log_controller.logs.logs.length"
                    class="pager">
                    <li class="previous"
                        ng-class="{disabled: log_controller.curPage == 0||ngDisabled, previous: align}">
                        <a class="ng-binding" href=""
                           ng-click="log_controller.curPage= log_controller.curPage-1">«
                            Anterior</a>
                    </li>
                    <li class="next"
                        ng-class="{disabled: log_controller.curPage >=  log_controller.logs.logs.length/ log_controller.pageSize - 1||ngDisabled, next: align}">
                        <a class="ng-binding" href=""
                           ng-click="log_controller.curPage =  log_controller.curPage+1">Siguiente
                            »</a>
                    </li>

                </ul>
            </div>
        </div>
        <!-- /.row -->
    </div>
</div>